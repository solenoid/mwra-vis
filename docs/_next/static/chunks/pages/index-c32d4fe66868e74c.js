(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return a(5743)}])},5743:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return D}});var n=a(5893),r=a(3382),s=a(3238),i=a(7927),l=a(465),o=a(1664),u=a.n(o),d=a(7294),c=a(5134),h=a(5301),m=a(1743);function x(e){let{options:t}=e,a=(0,d.useRef)(null);return(0,d.useEffect)(()=>{let e=a.current;if(e){let n=e.children[0];n&&n.remove(),e.appendChild(m.g(t))}},[a,t]),(0,n.jsx)("div",{ref:a})}function p(e){let{maxY:t,minX:a,maxX:r,data:s}=e;return s.length>0?(0,n.jsx)(x,{options:{x:{domain:[a,r],type:"time",ticks:10,label:"Sample Date →",labelOffset:35},y:{domain:[0,t],grid:!0,label:"↑ North System Copies / mL"},width:1e3,height:250,margin:45,marks:[c.AK(s,{x:"sampleDate",y:"northernCopies",fill:"#0806"}),h.jv(s,{x:"sampleDate",y:"northern7DayAvg"})],style:{background:"#4444",padding:"0 10px 10px"}}}):null}function g(e){let{maxY:t,minX:a,maxX:r,data:s}=e;return s.length>0?(0,n.jsx)(x,{options:{x:{domain:[a,r],type:"time",ticks:10,label:"Sample Date →",labelOffset:35},y:{domain:[0,t],grid:!0,label:"↑ South System Copies / mL"},width:1e3,height:250,margin:45,marks:[c.AK(s,{x:"sampleDate",y:"southernCopies",fill:"#8406"}),h.jv(s,{x:"sampleDate",y:"southern7DayAvg"})],style:{background:"#4444",padding:"0 10px 10px"}}}):null}let f=(e,t)=>{switch(t.type){case"FETCH_TEXT_INIT":return{...e,isLoading:!0,isError:!1};case"FETCH_TEXT_SUCCESS":return{...e,isLoading:!1,isError:!1,textData:t.payload};case"FETCH_TEXT_FAILURE":return{...e,isLoading:!1,isError:!0};default:throw Error()}},j=e=>{let[t,a]=(0,d.useState)(e),[n,r]=(0,d.useReducer)(f,{isLoading:!1,isError:!1,textData:""});return(0,d.useEffect)(()=>{let e=async()=>{r({type:"FETCH_TEXT_INIT"});try{let e=await fetch(t).then(e=>e.text());r({type:"FETCH_TEXT_SUCCESS",payload:e})}catch(a){r({type:"FETCH_TEXT_FAILURE"})}};t&&e()},[t]),{...n,setUrl:a}};var E=a(7712);let v=(e,t,a)=>a[e]?{[t]:Number(a[e])}:{},y=e=>{let[t,a,n]=e.split("/");return"".concat(n,"-").concat(t.padStart(2,"0"),"-").concat(a.padStart(2,"0"),"T00:00")},T=e=>E.ueB(e,e=>({sampleDate:y(e["Sample Date"]),...v("Northern (copies/mL)","northernCopies",e),...v("Southern (copies/mL)","southernCopies",e),...v("Northern 7 day avg","northern7DayAvg",e),...v("Southern 7 day avg","southern7DayAvg",e)})).filter(e=>e.northernCopies||e.southernCopies),C=e=>"".concat("/mwra-vis","/data/").concat(e);var D=function(){let{textData:e}=j(C("latest.csv")),t=T(e),[a,o]=(0,d.useState)(0),[c,h]=(0,d.useState)(0),[m,x]=(0,d.useState)(0),[f,E]=(0,d.useState)(1);(0,d.useEffect)(()=>{var e,a,n;if(null===(e=t[0])||void 0===e?void 0:e.sampleDate){let r=null===(a=t[t.length-1])||void 0===a?void 0:a.sampleDate,s=t[0].sampleDate,i=null===(n=t[t.length-7])||void 0===n?void 0:n.sampleDate;o(new Date(r).getTime()),h(new Date(s).getTime()),x(new Date(s).getTime()),E(new Date(i).getTime())}},[e]);let[v,y]=(0,d.useState)(1e3);return(0,n.jsxs)("div",{children:[(0,n.jsx)(s.aG,{borderBottomColor:"gray.500",children:(0,n.jsx)(s.gN,{children:(0,n.jsx)(s.At,{as:u(),href:"/",children:"Home"})})}),(0,n.jsx)(i.iz,{}),(0,n.jsx)(i.X6,{as:"h1",size:"l",marginY:3,children:"Wastewater COVID-19 Tracking"}),t.length>0?(0,n.jsxs)(i.xu,{children:[(0,n.jsxs)(i.Kq,{children:[(0,n.jsxs)(i.xv,{children:["Unofficial Alternative data vis for the Massachusetts Water Resources Authority sourced from"," ",(0,n.jsxs)(i.rU,{href:"https://www.mwra.com/biobot/biobotdata.htm",color:"teal.500",isExternal:!0,children:["Biobot Data",(0,n.jsx)(r.h0,{mx:"2px"})]})]}),(0,n.jsxs)(i.xv,{children:["Samples submitted through ",new Date(a).toDateString()]})]}),(0,n.jsxs)(i.kC,{children:[(0,n.jsx)(i.xu,{padding:3,children:(0,n.jsxs)(l.iR,{"aria-label":"Maximum Copies Scale",defaultValue:v,orientation:"vertical",minH:"32",step:100,min:250,max:1e4,onChange:y,children:[(0,n.jsx)(l.Uj,{children:(0,n.jsx)(l.Ms,{})}),(0,n.jsx)(l.gs,{})]})}),(0,n.jsx)(i.xu,{paddingY:3,children:(0,n.jsxs)(i.Kq,{children:[(0,n.jsx)(p,{maxY:v,minX:m,maxX:a,data:t}),(0,n.jsxs)(l.iR,{"aria-label":"Date Range Scale",defaultValue:m,orientation:"horizontal",step:2592e5,min:c,max:f,onChange:x,children:[(0,n.jsx)(l.Uj,{children:(0,n.jsx)(l.Ms,{})}),(0,n.jsx)(l.gs,{})]}),(0,n.jsx)(g,{maxY:v,minX:m,maxX:a,data:t})]})})]})]}):null]})}}},function(e){e.O(0,[731,774,888,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);